import"./modulepreload-polyfill.js";import{m as r}from"./module.esm.js";const c="/";r.store("prescription",{currMed:{id:-1,name:"",intakeAfter:"0",atBreakfast:!1,atLunch:!1,atDinner:!1,remarks:""},medicines:[],medSuggestions:[],openHint:!1,selectMed(e,i){this.currMed={...this.currMed,id:e,name:i},this.openHint=!1},fetchHints(){this.currMed.name.length<2||fetch(c+"chillpill/functions/getMedicineHints.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:this.currMed.name})}).then(e=>e.json()).then(e=>{this.openHint=!0,this.medSuggestions=e.data})},resetCurrMed(){this.currMed={id:-1,name:"",intakeAfter:"0",atBreakfast:!1,atLunch:!1,atDinner:!1,remarks:""}},addMedicine(){this.currMed.name===""||this.openHint||this.medicines.find(e=>e.id===this.currMed.id)||(this.medicines.push({...this.currMed}),this.resetCurrMed())},deleteMedicine(e){this.medicines=this.medicines.filter(i=>i.id!==e)},send(e,i){console.log(this.medicines),fetch(`${c}chillpill/functions/createPrescription.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctorId:e,patientId:i,medicines:this.medicines})}).then(t=>t.json()).then(t=>{if(console.log(t),t.success){console.log(t);let o=`Dear Sir, ${t.doctorName} has prescribed you the following medicines. 
`;const n=document.getElementById("prespriptionPage");n.removeChild(n.lastChild),n.removeChild(n.lastChild),o+=n.innerText,console.log(o);var s=new XMLHttpRequest;s.open("GET",`https://platform.clickatell.com/messages/http/send?apiKey=Hpxv3IC4RrKZWWfz-mpCTw==&to=88${i}&content=${encodeURIComponent(o)}`,!0),s.onreadystatechange=function(){s.readyState==4&&s.status==200&&console.log("success")},s.send(),window.location.href="/chillpill/dashboard/"}}).catch(t=>{console.log(t)})}});window.Alpine=r;r.start();
